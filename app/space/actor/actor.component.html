<form [formGroup]="form">
    <header (mouseenter)="manager.mode ==  editMode.edit ? mode = editMode.edit : null"
            (mouseleave)="mode = editMode.view">
        <ng-container *ngIf="mode == editMode.edit; else viewHeader">
            <input name formControlName="name">
        </ng-container>
    </header>

    <ng-template #viewHeader>
        <h1 name>{{actor.name}}</h1>
    </ng-template>
    <h3>As <b>{{actor.name}}</b> I want:</h3>

    <ul>
        <li *ngFor="let group of (actor.features | groupFeaturesByEpic:version); let i = index; trackBy: trackFeature;">
            <h4>
                <span>{{group.epic?.title}}</span>
            </h4>
            <ul>
                <li *ngFor="let feature of group.features">
                    <jnt-stack *ngIf="manager.mode ==  editMode.edit" actions [gutter]="ui.stack.gutter.tiny">
                        <jnt-button [icon]="ui.icons.delete"
                                    [size]="ui.sizes.tiny"
                                    [scheme]="ui.schemes.secondary"
                                    (click)="deleteFeature(feature.id)">
                        </jnt-button>
                    </jnt-stack>
                    <app-feature [feature]="feature"
                                 [dndDropzone]="['epic']"
                                 [dndEffectAllowed]="'copyLink'"
                                 (dndDrop)="onDropEpic(feature, $event)"></app-feature>
                </li>
            </ul>
        </li>
        <li *ngIf="manager.mode == editMode.edit">
            <jnt-button [icon]="ui.icons.plus" [size]="ui.sizes.tiny"
                        [scheme]="ui.schemes.secondary"
                        (click)="addFeature()"></jnt-button>
        </li>
    </ul>
</form>
