<header [formGroup]="form"
        (mouseenter)="manager.mode ==  editMode.edit ? mode = editMode.edit : null"
        (mouseleave)="mode = editMode.view">
  <ng-container *ngIf="mode == editMode.edit; else viewHeader">
    <input data-title formControlName="title">
    <div data-auto-name>
      <label [attr.checked]="autoNameControl.value">
        <input type="checkbox" formControlName="autoName">
      </label>
      <input data-name formControlName="name">
    </div>
  </ng-container>
</header>

<ng-template #viewHeader>
  <h1 data-title>{{package.title}}</h1>
  <div data-auto-name>
    <label [attr.checked]="autoNameControl.value">
    </label>
    <h2 data-name>{{package.name}}</h2>
  </div>
</ng-template>

<ng-template #addTemplate>
  <jnt-menu [orientation]="ui.orientation.vertical">
    <jnt-menu-item title="Entity"
                   (click)="addEntity()"></jnt-menu-item>
    <jnt-menu-item title="Enum"
                   (click)="addEnum()"></jnt-menu-item>
  </jnt-menu>
</ng-template>

<jnt-row cdkDropList
         (cdkDropListDropped)="moveEntity($event)"
         [cdkDropListData]="package.entities">
  <jnt-col cdkDrag *ngFor="let entity of package.entities; let i = index;"
           [wide]="4"
           [tablet]="6">
    <jnt-stack data-entity-item
               [orientation]="ui.orientation.horizontal"
               [align]="ui.align.stretch">
      <jnt-stack data-actions
                 [gutter]="ui.gutter.small">
        <jnt-button [icon]="ui.icons.edit"
                    [size]="ui.size.tiny"
                    [scheme]="ui.scheme.secondary"
                    [shape]="ui.shape.circle"
                    (click)="router.navigate([package.id, 'entities', entity.id], {relativeTo: route})">
        </jnt-button>
        <jnt-button cdkDragHandle *ngIf="manager.mode == editMode.edit"
                    [icon]="ui.icons.expand"
                    [size]="ui.size.tiny"
                    [shape]="ui.shape.circle"
                    [scheme]="ui.scheme.secondary">
        </jnt-button>
      </jnt-stack>
      <spec-entity data-entity [entity]="entity"></spec-entity>
      <jnt-button *ngIf="manager.mode == editMode.edit"
                  [icon]="ui.icons.delete"
                  [size]="ui.size.tiny"
                  [scheme]="ui.scheme.secondary"
                  [shape]="ui.shape.circle"
                  (click)="deleteEntity(i)">
      </jnt-button>
    </jnt-stack>
  </jnt-col>
  <jnt-col cdkDrag *ngFor="let enum of package.enums; let i = index;"
           [wide]="4"
           [tablet]="6">
    <jnt-stack data-entity-item
               [orientation]="ui.orientation.horizontal"
               [align]="ui.align.stretch">
      <jnt-stack data-actions
                 [gutter]="ui.gutter.small">
        <jnt-button [icon]="ui.icons.edit"
                    [size]="ui.size.tiny"
                    [scheme]="ui.scheme.secondary"
                    [shape]="ui.shape.circle"
                    (click)="router.navigate([package.id, 'enums', enum.id], {relativeTo: route})">
        </jnt-button>
        <jnt-button cdkDragHandle *ngIf="manager.mode == editMode.edit"
                    [icon]="ui.icons.expand"
                    [size]="ui.size.tiny"
                    [shape]="ui.shape.circle"
                    [scheme]="ui.scheme.secondary">
        </jnt-button>
      </jnt-stack>
      <spec-enum data-enum [enum]="enum"></spec-enum>
      <jnt-button *ngIf="manager.mode == editMode.edit"
                  [icon]="ui.icons.delete"
                  [size]="ui.size.tiny"
                  [scheme]="ui.scheme.secondary"
                  [shape]="ui.shape.circle"
                  (click)="deleteEnum(i)">
      </jnt-button>
    </jnt-stack>
  </jnt-col>
  <jnt-col *ngIf="manager.mode == editMode.edit"
           [wide]="4"
           [tablet]="6">
    <jnt-button [icon]="ui.icons.add"
                [size]="ui.size.tiny"
                [scheme]="ui.scheme.secondary"
                [shape]="ui.shape.circle"
                [jntPopover]="{contentTemplate: addTemplate, trigger: ui.trigger.click}"
                (attached)="instance.popover = $event"></jnt-button>
  </jnt-col>
</jnt-row>

