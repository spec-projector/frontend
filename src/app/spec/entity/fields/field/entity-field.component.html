<jnt-row [formGroup]="form">
  <jnt-col [span]="4" (mouseenter)="manager.mode == editMode.edit ? mode.header = editMode.edit : null"
           (mouseleave)="mode.header = editMode.view">
    <header>
      <ng-container *ngIf="mode.header == editMode.edit;else viewHeaderTemplate">
        <input title formControlName="title">
        <div naming>
          <label [attr.checked]="autoName.value">
            <input type="checkbox" formControlName="autoName">
          </label>
          <input name formControlName="name">
        </div>
      </ng-container>
      <ng-template #viewHeaderTemplate>
        <h1 title>{{field.title}}</h1>
        <div naming>
          <label [attr.checked]="autoName.value"> </label>
          <h2 name>{{field.name}}</h2>
        </div>
      </ng-template>
    </header>
  </jnt-col>
  <jnt-col [span]="2" (mouseenter)="manager.mode == editMode.edit ? mode.required = editMode.edit : null">
    <ng-container *ngIf="mode.required === editMode.edit;else viewRequiredTemplate">
      <jnt-checkbox formControlName="required"
                    label="required"
                    label-i18n="@@label.required"></jnt-checkbox>
    </ng-container>
    <ng-template #viewRequiredTemplate>
      <ng-template #notRequiredTemplate>
        <jnt-label *ngIf="manager.mode == editMode.edit"
                   [size]="ui.size.small"
                   [color]="ui.color.paleNavy"
                   label="not required"></jnt-label>
      </ng-template>
      <jnt-label *ngIf="field.required;else notRequiredTemplate"
                 [size]="ui.size.small"
                 [color]="ui.color.redDark"
                 label="required"></jnt-label>
    </ng-template>
  </jnt-col>
  <jnt-col [span]="4" (mouseenter)="manager.mode == editMode.edit ? mode.type = editMode.edit : null">
    <jnt-stack *ngIf="mode.type === editMode.edit;else viewTypeTemplate">
      <jnt-select formControlName="type"
                  [size]="ui.size.small">
        <jnt-select-option label="boolean"
                           [key]="fieldType.boolean"></jnt-select-option>
        <jnt-select-option label="string"
                           [key]="fieldType.string"></jnt-select-option>
        <jnt-select-option label="number"
                           [key]="fieldType.number"></jnt-select-option>
        <jnt-select-option label="date"
                           [key]="fieldType.date"></jnt-select-option>
        <jnt-select-option label="reference"
                           [key]="fieldType.reference"></jnt-select-option>
        <jnt-select-option label="array"
                           [key]="fieldType.array"></jnt-select-option>
      </jnt-select>
      <ng-template #entityOptionTemplate let-entity="value">
        <jnt-stack [orientation]="ui.orientation.horizontal"
                   [align]="ui.align.center"
                   [gutter]="ui.gutter.small">
          <ng-container *ngIf="entity.package != field.entity.package">
            <span>{{entity.package.title}}</span>
            <jnt-icon [icon]="ui.icons.chevronRight"
                      [size]="ui.size.tiny"></jnt-icon>
          </ng-container>
          <span>{{entity.title}}</span>
        </jnt-stack>
      </ng-template>
      <jnt-select formControlName="reference"
                  *ngIf="typeControl.value == fieldType.reference || typeControl.value == fieldType.array"
                  placeholder="Select entity"
                  [optionTemplate]="entityOptionTemplate"
                  [size]="ui.size.small">
        <jnt-select-option
          *ngFor="let entity of (field.entity.package.spec.packages | groupEntities);trackBy: trackEntity"
          [value]="entity"
          [key]="entity.id">
        </jnt-select-option>
      </jnt-select>
    </jnt-stack>

    <ng-template #viewTypeTemplate>
      <ng-container [ngSwitch]="field.type">
        <ng-container *ngSwitchCase="fieldType.reference">
          <jnt-link [title]="field.links.reference?.title"></jnt-link>
        </ng-container>
        <ng-container *ngSwitchCase="fieldType.array">
          [
          <jnt-link [title]="field.links.reference?.title"></jnt-link>
          , ...]
        </ng-container>
        <ng-container *ngSwitchDefault>
          <small>{{field.type}}</small>
        </ng-container>
      </ng-container>
    </ng-template>

  </jnt-col>
</jnt-row>
