<form [formGroup]="form" (mouseenter)="manager.mode == editMode.edit ? mode = editMode.edit : null"
      (mouseleave)="mode = editMode.view">
  <div editor *ngIf="mode == editMode.edit">
    <header>
      <input title fitWidth formControlName="title">
      <div naming>
        <label [attr.checked]="autoName.value">
          <input type="checkbox" formControlName="autoName">
        </label>
        <input name fitWidth formControlName="name">
      </div>
    </header>
    <div [attr.typing]="typeControl.value">
      <jnt-switcher formControlName="type"
                    [orientation]="ui.orientation.vertical">
        <jnt-switcher-option label="boolean" [value]="fieldType.boolean"></jnt-switcher-option>
        <jnt-switcher-option label="string" [value]="fieldType.string"></jnt-switcher-option>
        <jnt-switcher-option label="number" [value]="fieldType.number"></jnt-switcher-option>
        <jnt-switcher-option label="date" [value]="fieldType.date"></jnt-switcher-option>
        <jnt-switcher-option label="reference" [value]="fieldType.reference"></jnt-switcher-option>
        <jnt-switcher-option label="array" [value]="fieldType.array"></jnt-switcher-option>
      </jnt-switcher>
      <br>
      <label>
        <jnt-stack [orientation]="ui.orientation.horizontal"
                   [gutter]="ui.gutter.tiny">
          <jnt-checkbox formControlName="required"
                        label="required"
                        label-i18n="@@label.required"
                        [size]="ui.size.small"></jnt-checkbox>
        </jnt-stack>
      </label>
      <br>
      <ng-container *ngIf="typeControl.value == fieldType.reference || typeControl.value == fieldType.array">
        <select formControlName="reference">
          <option *ngFor="let entity of (field.entity.package.spec.packages | groupEntities);
                            trackBy: trackEntity" [value]="entity.id">
            {{entity.package != field.entity.package ? entity.package.title + ' / ' : ''}}{{entity.title}}
          </option>
        </select>
      </ng-container>
    </div>
  </div>
  <header>
    <h1 title>{{field.title}}
      <jnt-label *ngIf="field.required"
                 [size]="ui.size.small"
                 [color]="ui.color.redDark"
                 label="required"></jnt-label>
    </h1>
    <div naming>
      <label [attr.checked]="autoName.value"> </label>
      <h2 name>{{field.name}}</h2>
    </div>
  </header>
  <div [attr.typing]="typeControl.value">
    <ng-container [ngSwitch]="field.type">
      <ng-container *ngSwitchCase="fieldType.reference">
        &rarr;
        <jnt-link [title]="field.links.reference?.title"></jnt-link>
      </ng-container>
      <ng-container *ngSwitchCase="fieldType.array">
        &rarr; [
        <jnt-link [title]="field.links.reference?.title"></jnt-link>
        , ...]
      </ng-container>
      <ng-container *ngSwitchDefault>
        <small>{{field.type}}</small>
      </ng-container>
    </ng-container>
  </div>
</form>
