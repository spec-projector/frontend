<jnt-app-page-header title="Specification"
                     i18n-title="@@label.specification"
                     [icon]="localUi.icons.general"></jnt-app-page-header>
<jnt-block [width]="ui.width.fluid"
           [padding]="ui.gutter.none">
  <jnt-form [formGroup]="form"
            (submitted)="save()">
    <jnt-tabs>

      <jnt-tab *ngIf="me.isStaff" title="For staff"
               i18n-title="@@label.for_staff">
        <ng-template #tabContentTemplate>
          <jnt-button text="Demo" (click)="fillDemo()"></jnt-button>
        </ng-template>
      </jnt-tab>

      <jnt-tab title="Resource types"
               i18n-title="@@label.resource_types">
        <jnt-badge *ngIf="resourceTypesArray.length > 0"
                   [value]="resourceTypesArray.length"></jnt-badge>
        <ng-template #tabContentTemplate>
          <ng-template #noResourceTypesTemplate>
            <p [ngSwitch]="locale">
              <ng-container *ngSwitchDefault>
                Resources are used for implementing features.
              </ng-container>
              <ng-container *ngSwitchCase="language.ru">
                Ресурсы используемые для расширения возможности.
              </ng-container>
            </p>
            <jnt-button text="Fill resources"
                        [icon]="ui.icons.add"
                        (click)="fillResources()"></jnt-button>
          </ng-template>
          <ng-container *ngIf="resourceTypesArray.controls.length > 0;else noResourceTypesTemplate"
                        formArrayName="resourceTypes">
            <jnt-stack [align]="ui.align.stretch">
              <jnt-stack [orientation]="ui.orientation.horizontal">
                <jnt-button [icon]="ui.icons.add"
                            [shape]="ui.shape.circle"
                            (click)="addResource()"></jnt-button>
              </jnt-stack>
              <jnt-row>
                <jnt-col [desktop]="4" [mobile]="6">
                  <b>Title</b>
                </jnt-col>
                <jnt-col [desktop]="2" [mobile]="4">
                  <b>Hour rate</b>
                </jnt-col>
              </jnt-row>
              <jnt-row *ngFor="let r of resourceTypesArray.controls; let i = index"
                       [formGroupName]="i">
                <jnt-col [desktop]="4" [mobile]="6">
                  <jnt-input placeholder="Title"
                             i18n-placeholder="@@label.title"
                             formControlName="title"
                             [width]="ui.width.fluid"></jnt-input>
                </jnt-col>
                <jnt-col [desktop]="2" [mobile]="4">
                  <jnt-input placeholder="Hour rate"
                             i18n-placeholder="@@label.hour_rate"
                             formControlName="hourRate"
                             [type]="ui.input.type.number"
                             [width]="ui.width.fluid"></jnt-input>
                </jnt-col>
                <jnt-col [desktop]="2" [mobile]="2">
                  <jnt-button [icon]="ui.icons.delete"
                              [scheme]="ui.scheme.secondary"
                              [shape]="ui.shape.circle"
                              [type]="ui.button.type.button"
                              (click)="deleteResourceType(i)"></jnt-button>
                </jnt-col>
              </jnt-row>
            </jnt-stack>
          </ng-container>
        </ng-template>
      </jnt-tab>

      <jnt-tab title="Maintenance"
               i18n-title="@@label.maintenance">
        <ng-template #tabContentTemplate>
          <jnt-stack actions [orientation]="ui.orientation.horizontal">
            <div>
              <a href="javascript:;" #dumpFile></a>
              <jnt-button text="Dump"
                          i18n-text="@@action.dump"
                          (click)="dump(dumpFile)"></jnt-button>
            </div>
            <div>
              <jnt-button [loading]="progress.restore"
                          text="Restore"
                          i18n-text="@@action.restore"
                          (click)="restoreInput.click()"></jnt-button>
              <input #restoreInput fileInput type="file"
                     (change)="restore($event)">
            </div>
          </jnt-stack>
        </ng-template>
      </jnt-tab>

    </jnt-tabs>
  </jnt-form>
</jnt-block>
