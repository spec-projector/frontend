<jnt-app-page-header [icon]="localUi.icons.epics"
                     title="Epics"
                     i18n-title="@@label.epics"
                     teaser="groups of functions"
                     i18n-teaser="@@message.epics_teaser">
  <ng-template #headerActionsTemplate>
    <jnt-button *ngIf="manager.mode ==  editMode.edit"
                [icon]="ui.icons.add"
                [shape]="ui.shape.circle"
                (click)="addEpic()"></jnt-button>
  </ng-template>
</jnt-app-page-header>

<jnt-stack [align]="ui.align.stretch"
           [gutter]="ui.gutter.large">

  <ng-template #emptyDataTemplate>
    <jnt-message>
      <ng-container [ngSwitch]="locale">
        <ng-container *ngSwitchDefault>
          <p>Features could be grouped by similar area of applying.</p>
          <p>E.g. an actor <b>Client</b> wants <b>Register</b>, <b>Login</b>, <b>Restore password</b>. These features can be grouped by epic <b>User Accounts</b>.</p>
        </ng-container>
        <ng-container *ngSwitchCase="language.ru">
          <p>Возможности могут быть сгруппированы по схожей области применения.</p>
          <p>Например актёр <b>Клиент</b> хочет <b>Зарегистрироваться</b>, <b>Войти</b>, <b>Восстановить пароль</b>. Эти возможности могут быть сгруппированы по эпиу <b>Учетные записи пользователей</b>.</p>
        </ng-container>
      </ng-container>
      <jnt-button *ngIf="manager.mode ==  editMode.edit"
                  [icon]="ui.icons.add"
                  text="Add first epic"
                  (click)="addEpic()"></jnt-button>
    </jnt-message>
  </ng-template>

  <jnt-stack  *ngIf="spec.epics.length > 0; else emptyDataTemplate"
              cdkDropList [align]="ui.align.stretch"
             (cdkDropListDropped)="moveEpic($event)"
             [cdkDropListData]="spec.epics">
    <jnt-block cdkDrag *ngFor="let epic of spec.epics; let i = index; trackBy: trackEpic">
      <jnt-stack [orientation]="ui.orientation.horizontal">
        <jnt-stack data-actions *ngIf="manager.mode ==  editMode.edit"
                   [gutter]="ui.gutter.small">
          <jnt-button cdkDragHandle
                      [icon]="ui.icons.expand"
                      [size]="ui.size.tiny"
                      [shape]="ui.shape.circle"
                      [scheme]="ui.scheme.secondary">
          </jnt-button>
          <jnt-button [icon]="ui.icons.delete"
                      [size]="ui.size.tiny"
                      [shape]="ui.shape.circle"
                      [scheme]="ui.scheme.secondary"
                      [jntPopover]="{contentTemplate: deleteTemplate, trigger: ui.trigger.click}"
                      (attached)="instance.popover = $event">
          </jnt-button>
          <ng-template #deleteTemplate>
            <jnt-confirm message="Are you sure to delete the epic?"
                         i18n-message="@@message.sure_delete_epic"
                         (cancel)="instance.popover.hide()"
                         (ok)="deleteEpic(i);instance.popover.hide()"></jnt-confirm>
          </ng-template>
        </jnt-stack>
        <spec-epic data-epic [epic]="epic"></spec-epic>
      </jnt-stack>
    </jnt-block>
  </jnt-stack>
</jnt-stack>


