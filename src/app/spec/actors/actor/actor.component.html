<header (mouseenter)="manager.mode ==  editMode.edit ? mode = editMode.edit : null"
        (mouseleave)="mode = editMode.view">
  <ng-container [formGroup]="form" *ngIf="mode == editMode.edit; else viewHeader">
    <input #nameRef data-name formControlName="name">
  </ng-container>
</header>

<ng-template #viewHeader>
  <h1 data-name>{{actor.name}}</h1>
</ng-template>

<h3 [ngSwitch]="consts.language">
  <ng-container *ngSwitchDefault>
    As <b>{{actor.name}}</b> I want feature:
  </ng-container>
  <ng-container *ngSwitchCase="language.ru">
    Как <b>{{actor.name}}</b> я хочу функцию:
  </ng-container>
</h3>

<ul data-modules>
  <li data-module *ngFor="let group of (actor.features | groupFeaturesByModules:version); trackBy: trackFeature">
    <h4>
      <span>{{group.module?.title}}</span>
    </h4>
    <jnt-row>
      <jnt-col *ngFor="let feature of group.features; trackBy: trackFeature"
               [wide]="4" [tablet]="6">
        <jnt-card [width]="ui.width.fluid"
                  [padding]="ui.gutter.small">
          <jnt-stack [orientation]="ui.orientation.horizontal">
            <jnt-button [icon]="ui.icons.link"
                        [size]="ui.size.tiny"
                        [scheme]="ui.scheme.secondary"
                        [shape]="ui.shape.circle"
                        (click)="router.navigate([actor.id, 'features', feature.id], {relativeTo: route})">
            </jnt-button>
            <spec-feature data-feature [attr.id]="feature.id"
                          [feature]="feature"
                          [mode]="added === feature.id ? editMode.edit : editMode.view"></spec-feature>
          </jnt-stack>

          <ng-template #cardActionsTemplate *ngIf="(manager.mode$ | async) === editMode.edit" let-hide="hide">
            <jnt-menu [orientation]="ui.orientation.vertical">
              <jnt-menu-item [icon]="ui.icons.delete"
                             title="Delete"
                             i18n-title="@@action.delete"
                             (click)="hide()"
                             [jntModal]="{content: deleteTemplate}">
              </jnt-menu-item>
            </jnt-menu>
          </ng-template>

          <ng-template #deleteTemplate>
            <jnt-confirm message="Are you sure to delete?"
                         i18n-message="@@message.are_you_sure_delete"
                         (cancel)="modal.close()"
                         (ok)="deleteFeature(feature)"></jnt-confirm>
          </ng-template>
        </jnt-card>
      </jnt-col>
    </jnt-row>
  </li>
  <li *ngIf="(manager.mode$ | async) == editMode.edit">
    <jnt-button text="Add feature"
                i18n-text="@@action.add_feature"
                [icon]="ui.icons.add"
                [size]="ui.size.tiny"
                [scheme]="ui.scheme.secondary"
                (click)="addFeature()">
    </jnt-button>
  </li>

</ul>
